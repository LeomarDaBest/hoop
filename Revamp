-- Services
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")

local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local Humanoid = Character:WaitForChild("Humanoid")
local RootPart = Character:WaitForChild("HumanoidRootPart")

-- Find the hoop (adjust if needed, e.g., if it's in a different location)
local Hoop = Workspace:FindFirstChild("Hoop")

-- UI Creation for Mobile
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "HoopzUI"
ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false  -- Persists through respawns

-- Create toggle buttons (mobile-friendly: large size, simple text)
local CamlockButton = Instance.new("TextButton")
CamlockButton.Name = "CamlockToggle"
CamlockButton.Text = "Camlock: Off"
CamlockButton.Size = UDim2.new(0, 150, 0, 60)  -- Larger for mobile tapping
CamlockButton.Position = UDim2.new(0, 10, 0, 10)
CamlockButton.BackgroundColor3 = Color3.fromRGB(0, 100, 200)
CamlockButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CamlockButton.Parent = ScreenGui

local AutoPowerButton = Instance.new("TextButton")
AutoPowerButton.Name = "AutoPowerToggle"
AutoPowerButton.Text = "Auto Power: Off"
AutoPowerButton.Size = UDim2.new(0, 150, 0, 60)
AutoPowerButton.Position = UDim2.new(0, 170, 0, 10)
AutoPowerButton.BackgroundColor3 = Color3.fromRGB(0, 200, 100)
AutoPowerButton.TextColor3 = Color3.fromRGB(255, 255, 255)
AutoPowerButton.Parent = ScreenGui

local AutoGuardButton = Instance.new("TextButton")
AutoGuardButton.Name = "AutoGuardToggle"
AutoGuardButton.Text = "Auto Guard: Off"
AutoGuardButton.Size = UDim2.new(0, 150, 0, 60)
AutoGuardButton.Position = UDim2.new(0, 330, 0, 10)
AutoGuardButton.BackgroundColor3 = Color3.fromRGB(200, 100, 0)
AutoGuardButton.TextColor3 = Color3.fromRGB(255, 255, 255)
AutoGuardButton.Parent = ScreenGui

local SpeedboostButton = Instance.new("TextButton")
SpeedboostButton.Name = "SpeedboostToggle"
SpeedboostButton.Text = "Speedboost: Off"
SpeedboostButton.Size = UDim2.new(0, 150, 0, 60)
SpeedboostButton.Position = UDim2.new(0, 490, 0, 10)
SpeedboostButton.BackgroundColor3 = Color3.fromRGB(200, 0, 100)
SpeedboostButton.TextColor3 = Color3.fromRGB(255, 255, 255)
SpeedboostButton.Parent = ScreenGui

-- Toggles
local camlockEnabled = false
local autoPowerEnabled = false
local autoGuardEnabled = false
local speedboostEnabled = false

-- Button click handlers (works for mobile touches)
CamlockButton.MouseButton1Click:Connect(function()
    camlockEnabled = not camlockEnabled
    CamlockButton.Text = "Camlock: " .. (camlockEnabled and "On" or "Off")
end)

AutoPowerButton.MouseButton1Click:Connect(function()
    autoPowerEnabled = not autoPowerEnabled
    AutoPowerButton.Text = "Auto Power: " .. (autoPowerEnabled and "On" or "Off")
end)

AutoGuardButton.MouseButton1Click:Connect(function()
    autoGuardEnabled = not autoGuardEnabled
    AutoGuardButton.Text = "Auto Guard: " .. (autoGuardEnabled and "On" or "Off")
end)

SpeedboostButton.MouseButton1Click:Connect(function()
    speedboostEnabled = not speedboostEnabled
    SpeedboostButton.Text = "Speedboost: " .. (speedboostEnabled and "On" or "Off")
end)

-- Camlock Feature: Locks camera to the hoop when jumping
UserInputService.JumpRequest:Connect(function()
    if camlockEnabled and Hoop then
        local Camera = Workspace.CurrentCamera
        if Camera then
            Camera.CameraSubject = Hoop  -- Lock camera to the hoop
            Camera.CameraType = Enum.CameraType.Scriptable  -- Make it scriptable for control
        end
    end
end)

-- Auto Power Feature: Increases jump power when enabled
RunService.Stepped:Connect(function()
    if autoPowerEnabled then
        Humanoid.JumpPower = 75  -- Boosted jump power (default is around 50)
    else
        Humanoid.JumpPower = 50  -- Reset to default
    end
end)

-- Auto Guard Feature: Makes the character face the nearest opponent
RunService.Stepped:Connect(function()
    if autoGuardEnabled then
        local NearestOpponent = nil
        local NearestDistance = math.huge
        
        for _, Player in pairs(Players:GetPlayers()) do
            if Player ~= LocalPlayer and Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
                local OpponentRoot = Player.Character.HumanoidRootPart
                local Distance = (RootPart.Position - OpponentRoot.Position).Magnitude
                if Distance < NearestDistance and Distance < 50 then  -- Only consider opponents within 50 studs
                    NearestOpponent = OpponentRoot
                    NearestDistance = Distance
                end
            end
        end
        
        if NearestOpponent then
            RootPart.CFrame = CFrame.new(RootPart.Position, NearestOpponent.Position)  -- Face the opponent
        end
    end
end)

-- Speedboost Feature: Increases walk speed when enabled
RunService.Stepped:Connect(function()
    if speedboostEnabled then
        Humanoid.WalkSpeed = 30  -- Boosted speed (default is 16)
    else
        Humanoid.WalkSpeed = 16  -- Reset to default
    end
end)

print("Hoopz Script Loaded! Toggle features using the UI buttons.")
